{% extends 'app/base_generic.html' %}

{% block content %}

<script>
    function onChangeOrder(asc) {
        const url = new URL(window.location.href);
        url.searchParams.set('asc', asc);
        window.location.href = url
    }
</script>

<div class="flex justify-between flex-col align-center border-b border-base-200">
    <div class="join grid grid-cols-2 m-4">
        <a class="join-item btn btn-outline {% if page == 1 %}btn-disabled{% endif %}" href="{% url 'index' %}?page={{ page|add:-1 }}&tag={{ tag.id }}&asc={{ asc }}">Previous</a>
        <a class="join-item btn btn-outline" href="{% url 'index' %}?page={{ page|add:1 }}&tag={{ tag.id }}&asc={{ asc }}">Next</a>
    </div>
    <div class="form-control">
        <label class="label cursor-pointer">
            <span class="label-text">Ascending</span> 
            <input type="checkbox" class="toggle" {% if asc == 'true' %}checked{% endif %} onchange="onChangeOrder(this.checked)">
        </label>
    </div>
</div>
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
    {% for image in images %}
    <div class="card w-96 bg-base-200 shadow-lg m-4">
        <figure><img src="{% url 'image_render' image.id %}" alt="{{ image.name }}" class="max-h-96"></figure>
        <div class="card-body">
            <h2 class="card-title">{{ image.name }}</h2>
            <p>{{ image.description|safe|linebreaks }}</p>
            <div class="card-actions">
                {% for tag in image.tags.all %}
                    <a href="{% url 'index' %}?tag={{ tag.id }}" class="badge badge-secondary">{{ tag.name }}</a>
                {% endfor %}
            </div>
            <div class="card-actions justify-end">
                {% if user.is_authenticated %}
                    <a href="{% url 'image_edit' image.id %}" class="btn btn-primary">Edit</a>
                {% endif %}
                <a href="{% url 'image_detail' image.id %}" class="btn btn-primary">View</a>
            </div>
        </div>
    </div>
    {% endfor %}
</div>
{% endblock %}